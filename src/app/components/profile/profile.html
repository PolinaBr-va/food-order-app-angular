<div class="profile-container">
  <h2>Ваш профиль</h2>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
    <div class="form-group">
      <label for="fullName">ФИО:</label>
      <input type="text" id="fullName" formControlName="fullName" placeholder="Введите ваше ФИО" />
      @if (profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched) {
      <div class="error">Поле обязательно для заполнения</div>
      }
    </div>

    <div class="form-group">
      <label for="email">Электронная почта:</label>
      <input type="email" id="email" formControlName="email" placeholder="Введите вашу эл. почту" />
      @if (profileForm.get('email')?.invalid && profileForm.get('email')?.touched) {
      <div class="error">Поле обязательно для заполнения</div>
      }
    </div>

    <div class="form-group">
      <label for="phone">Номер телефона:</label>
      <input
        type="tel"
        id="phone"
        formControlName="phone"
        placeholder="Введите ваш номер телефона"
      />
      @if (profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched) {
      <div class="error">Поле обязательно для заполнения</div>
      }
    </div>

    <div class="form-group">
      <label for="address">Адрес доставки:</label>
      <textarea
        id="address"
        formControlName="address"
        rows="3"
        placeholder="Введите адрес доставки заказа"
      ></textarea>
      @if (profileForm.get('address')?.invalid && profileForm.get('address')?.touched) {
      <div class="error">Поле обязательно для заполнения</div>
      }
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="profileForm.invalid" class="save-btn">Сохранить</button>
      <button type="button" (click)="onCancel()" class="cancel-btn">Закрыть</button>
    </div>
  </form>

  @if (orderHistory.length > 0) {
  <div class="order-history">
    <h3>История заказов</h3>
    <div class="order-list">
      @for (order of orderHistory; track order.id) {
      <div class="order-item">
        <div class="order-header">
          <span class="order-id">Заказ № {{ order.id }}</span>
          <span class="order-date">{{ order.date | date : 'medium' }}</span>
          <span
            class="order-status"
            [style.background-color]="getStatusColor(order.status)"
            [style.color]="'white'"
          >
            {{ getStatusText(order.status) }}
          </span>
        </div>
        <div class="order-details">
          <div class="order-items">
            {{ order.items.length }} позиций • сумма: {{ order.total }} руб.
          </div>
          <div class="order-actions">
            <button class="view-order-button" (click)="viewOrderDetails(order)">
              Детали заказа
            </button>
            <button class="reorder-btn" (click)="reorder(order)">Заказать повторно</button>
          </div>
        </div>
      </div>
      }
    </div>
  </div>
  } 
  @if (orderHistory.length === 0) {
  <div class="no-orders">
    <h3>История заказов</h3>
    <p>У вас еще нет завершенных заказов</p>
    <button class="start-shopping-btn" routerLink="/home">Начать покупки</button>
  </div>
  }
</div>
